# Copyright 2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

served-model-name: deepseek-ai/DeepSeek-R1
# log-level: DEBUG
disaggregation-mode: prefill
disaggregation-bootstrap-port: "30001"
host: "0.0.0.0"
port: "9090"
trust-remote-code: true
tp-size: "8"
dp-size: "8"
ep-size: "8"
quantization: "fp8"
enable-dp-attention: true
attention-backend: "trtllm_mla"
kv-cache-dtype: "fp8_e4m3"
disable-radix-cache: true
stream-interval: "50"
max-running-requests: "30000"
context-length: "9300"
# decode-log-interval: "1"
# page-size: "1"
# disaggregation-transfer-backend: nixl
watchdog-timeout: "1000000"
disable-shared-experts-fusion: true
eplb-algorithm: deepseek
mem-fraction-static: "0.8"
max-total-tokens: "524288"
chunked-prefill-size: "131072"
load-balance-method: round_robin
disable-cuda-graph: true
moe-a2a-backend: deepep
deepep-mode: normal
ep-dispatch-algorithm: "dynamic"
moe-dense-tp-size: "1"
enable-dp-lm-head: true
ep-num-redundant-experts: "32"
deepep-config: '{"normal_dispatch": {"num_sms": 128,"num_max_nvl_chunked_send_tokens": 28,"num_max_nvl_chunked_recv_tokens": 256,"num_max_rdma_chunked_send_tokens": 6,"num_max_rdma_chunked_recv_tokens": 256}, "normal_combine": {"num_sms": 128,"num_max_nvl_chunked_send_tokens": 15,"num_max_nvl_chunked_recv_tokens": 256,"num_max_rdma_chunked_send_tokens": 6,"num_max_rdma_chunked_recv_tokens": 128}}'